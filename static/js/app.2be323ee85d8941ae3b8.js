webpackJsonp([10],{NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("7+uW"),a=n("Dd8w"),o=n.n(a),i=n("NYxO"),s=n("zL8q"),u=n.n(s),c={name:"headers",data:function(){return{}},computed:o()({},Object(i.c)(["isLogin","user"])),created:function(){this.checkLogin()},methods:o()({},Object(i.b)(["checkLogin","loginout"]),{onloginout:function(){var e=this;this.loginout().then(function(){s.Message.success("成功注销"),e.$router.push("/")})}})},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isLogin?n("header",{staticClass:"header-one"},[n("h1",[n("router-link",{attrs:{to:"/"}},[e._v("LET'S SHARE")])],1),e._v(" "),n("div",{staticClass:"icon_img"},[n("router-link",{attrs:{to:"/create"}},[n("span",[n("i",{staticClass:"edit el-icon-edit"})])]),e._v(" "),n("div",{staticClass:"menu"},[n("img",{staticClass:"img",attrs:{src:e.user.avatar}}),e._v(" "),n("ul",{staticClass:"user_ul"},[n("router-link",{attrs:{to:"/myblog"}},[n("li",[e._v("我的")])]),e._v(" "),n("li",{on:{click:e.onloginout}},[e._v("注销")])],1)])],1)]):n("header",{staticClass:"header-tow"},[n("h1",[n("router-link",{attrs:{to:"/"}},[e._v("LET'S SHARE")])],1),e._v(" "),n("p",[e._v("精品博客汇聚")]),e._v(" "),n("router-link",{attrs:{to:"/login"}},[n("el-button",[e._v("立即登录")])],1),e._v(" "),n("router-link",{attrs:{to:"/register"}},[n("el-button",[e._v("注册账号")])],1)],1)])},staticRenderFns:[]};var d={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{attrs:{id:"footers"}},[this._v("共享博客")])},staticRenderFns:[]};var f={name:"App",components:{Headers:n("VU/8")(c,l,!1,function(e){n("zGjR")},"data-v-3c604807",null).exports,Footers:n("VU/8")({name:"footers"},d,!1,function(e){n("gAVl")},"data-v-be16de2a",null).exports}},h={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("Headers",{attrs:{id:"headers"}}),this._v(" "),t("main",{attrs:{id:"main"}},[t("router-view")],1),this._v(" "),t("Footers",{attrs:{id:"footers"}})],1)},staticRenderFns:[]};var g=n("VU/8")(f,h,!1,function(e){n("OjO2")},null,null).exports,m=n("/ocq"),p=n("Xxa5"),v=n.n(p),b=n("exGp"),L=n.n(b),w=n("p+dL"),_="/auth/register",k="/auth/login",O="/auth/logout",A="/auth",j={register:function(e){var t=e.username,n=e.password;return Object(w.a)(_,"POST",{username:t,password:n})},login:function(e){var t=e.username,n=e.password;return Object(w.a)(k,"POST",{username:t,password:n})},loginout:function(){return Object(w.a)(O,"GET")},checkLogin:function(){return Object(w.a)(A,"GET")}},x={state:{user:null,isLogin:!1},getters:{isLogin:function(e){return e.isLogin},user:function(e){return e.user}},mutations:{setUser:function(e,t){e.user=t.user},setLogin:function(e,t){e.isLogin=t.isLogin}},actions:{login:function(e,t){var n=e.commit,r=t.username,a=t.password;return j.login({username:r,password:a}).then(function(e){n("setUser",{user:e.data}),n("setLogin",{isLogin:!0})})},register:function(e,t){var n=e.commit,r=t.username,a=t.password;return j.register({username:r,password:a}).then(function(e){n("setUser",{user:e.data}),n("setLogin",{isLogin:!0})})},loginout:function(e){var t=e.commit;return j.loginout().then(function(e){t("setUser",{user:null}),t("setLogin",{isLogin:!1})})},checkLogin:function(e){var t=this,n=e.commit,r=e.state;return L()(v.a.mark(function e(){var a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isLogin){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,j.checkLogin();case 4:if(a=e.sent,n("setLogin",{isLogin:a.isLogin}),a.isLogin){e.next=8;break}return e.abrupt("return",!1);case 8:return n("setUser",{user:a.data}),e.abrupt("return",!0);case 10:case"end":return e.stop()}},e,t)}))()}}};r.default.use(i.a);var E=new i.a.Store({modules:{auth:x,blog:{state:{},getter:{},mutations:{},action:{}}}});r.default.use(m.a);var P=new m.a({routes:[{path:"/login",name:"Login",component:function(){return n.e(2).then(n.bind(null,"P7ry"))}},{path:"/register",name:"Register",component:function(){return n.e(4).then(n.bind(null,"S2NW"))}},{path:"/",name:"Index",component:function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,"eerB"))}},{path:"/create",name:"Create",component:function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"zwgt"))},meta:{requiresAuth:!0}},{path:"/article/:blogId",name:"Article",component:function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"M6c9"))}},{path:"/edit/:blogId",name:"Edit",component:function(){return Promise.all([n.e(0),n.e(8)]).then(n.bind(null,"7A5/"))},meta:{requiresAuth:!0}},{path:"/myblog",name:"Myblog",component:function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,"+P+Z"))},meta:{requiresAuth:!0}},{path:"/userblog/:userId",name:"Userblog",component:function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,"Za7m"))}}]});P.beforeEach(function(e,t,n){e.matched.some(function(e){return e.meta.requiresAuth})?E.dispatch("checkLogin").then(function(t){t?n():n({path:"/login",query:{redirect:e.fullPath}})}):n()});var y=P,C=(n("tvR6"),n("mtWM")),M=n.n(C),R=n("pFYg"),T=n.n(R);function U(e){var t=("object"===(void 0===e?"undefined":T()(e))?e:new Date(e)).getTime(),n=Date.now()-t,r="";switch(!0){case n<6e4:r="刚刚";break;case n<36e5:r=Math.floor(n/6e4)+"分钟前";break;case n<864e5:r=Math.floor(n/6e4*60)+"小时前";break;default:r=Math.floor(n/864e5)+"天前"}return r}var q={install:function(e,t){e.prototype.friendlyDate=U}};window.app=j,r.default.config.productionTip=!1,r.default.use(u.a),r.default.use(q),r.default.prototype.$http=M.a,new r.default({el:"#app",router:y,store:E,components:{App:g},template:"<App/>"})},OjO2:function(e,t){},gAVl:function(e,t){},"p+dL":function(e,t,n){"use strict";t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new a.a(function(r,a){var o={url:e,method:t};"get"===t.toLowerCase()?o.params=n:o.data=n,i()(o).then(function(e){"ok"===e.data.status?r(e.data):(s.Message.error(e.data.msg),a(e.data))}).catch(function(e){s.Message.error("网络异常"),a({msg:"网络异常"})})})};var r=n("//Fk"),a=n.n(r),o=n("mtWM"),i=n.n(o),s=n("zL8q");n.n(s);i.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UFT-8;",i.a.defaults.baseURL="http://blog-server.hunger-valley.com",i.a.defaults.withCredentials=!0},tvR6:function(e,t){},zGjR:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.2be323ee85d8941ae3b8.js.map